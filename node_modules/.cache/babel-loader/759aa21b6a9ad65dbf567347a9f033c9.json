{"ast":null,"code":"import _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport Ticker from './ticker';\nimport Element from './animateElement';\nimport { dataToArray, getAnimatePos } from '../utils';\n\nvar AnimateGroup = function AnimateGroup(props) {\n  var _this = this;\n\n  _classCallCheck(this, AnimateGroup);\n\n  this.props = props;\n  this.children = [];\n  this.totalTime = 0;\n  this.totalTimeRegion = 0;\n  this.childTotalTime = 0;\n  this.childRegionTotalTime = 0;\n  this.progressTime = 0;\n  this.progressMoment = -1;\n  this.startMoment = 0;\n  this.startTime = 0;\n  this.repeatNum = 0;\n  this.mode = 'onTimelineStart';\n  this.regionStartTime = 0;\n\n  this.init = function () {\n    var _this$props = _this.props,\n        reverse = _this$props.reverse,\n        animation = _this$props.animation,\n        moment = _this$props.moment;\n    var animateArray = dataToArray(animation);\n\n    for (var i = 0; i < animateArray.length; i++) {\n      var item = animateArray[i];\n\n      if (item.type === 'set') {\n        item.duration = 0;\n      } //animateArray.forEach((item: any, i: number) => {\n\n\n      var animate = new Element(item);\n      animate.index = i;\n      var pos = i ? getAnimatePos(item, animateArray[i - 1]) : 0;\n      item.appearTo = pos;\n      animate.appearTo = pos;\n\n      _this.addChild(animate); //});\n\n    } // 注册\n\n\n    _this.render({\n      time: (reverse ? _this.totalTime : 0) + _this.startTime,\n      elapsed: 16.67\n    });\n\n    if (!_this.totalTime) {\n      _this.render({\n        time: (reverse ? _this.totalTime : 0) + _this.startTime,\n        elapsed: 16.67\n      });\n    }\n\n    if (moment) {\n      _this.goto(moment);\n    } else {\n      _this.play();\n    }\n  };\n\n  this.addChild = function (animate) {\n    animate.parent = _this;\n    animate.root = _this.root;\n\n    if (_this.children.indexOf(animate) === -1) {\n      _this.children.push(animate);\n\n      _this.setTotalTime();\n    }\n  };\n\n  this.setTotalTime = function () {\n    _this.childTotalTime = 0;\n    _this.childRegionTotalTime = 0;\n\n    for (var i = 0; i < _this.children.length; i++) {\n      var item = _this.children[i];\n\n      if (item.appearTo !== _this.childTotalTime) {\n        var itemTime = item.appearTo + item.totalTime;\n\n        if (itemTime > _this.childTotalTime) {\n          _this.childTotalTime = itemTime;\n          _this.childRegionTotalTime = itemTime;\n        }\n      } else {\n        _this.childTotalTime += item.totalTime;\n        _this.childRegionTotalTime += item.totalTime;\n      }\n    }\n\n    if (_this.regionStartTime) {\n      _this.childRegionTotalTime -= _this.regionStartTime;\n    }\n\n    if (_this.regionEndTime) {\n      _this.childRegionTotalTime = _this.regionEndTime - _this.regionStartTime;\n    }\n\n    var _this$props2 = _this.props,\n        _this$props2$repeat = _this$props2.repeat,\n        repeat = _this$props2$repeat === void 0 ? 0 : _this$props2$repeat,\n        _this$props2$repeatDe = _this$props2.repeatDelay,\n        repeatDelay = _this$props2$repeatDe === void 0 ? 0 : _this$props2$repeatDe,\n        delay = _this$props2.delay;\n    _this.totalTime = repeat === -1 ? Number.MAX_VALUE : delay + _this.childTotalTime * (repeat + 1) + repeatDelay * repeat;\n    _this.totalTimeRegion = repeat === -1 ? Number.MAX_VALUE : delay + _this.childRegionTotalTime * (repeat + 1) + repeatDelay * repeat;\n  };\n\n  this.setStartTimeOrMoment = function (start) {\n    _this.startTime = Ticker.time;\n    _this.startMoment = start || _this.progressMoment;\n  };\n\n  this.reRenderCall = function () {\n    _this.render({\n      time: _this.startTime,\n      elapsed: Ticker.elapsed || Ticker.frameFPS\n    });\n  };\n\n  this.play = function (v) {\n    if (!v) {\n      var _this$parent;\n\n      (_this$parent = _this.parent) === null || _this$parent === void 0 ? void 0 : _this$parent.addChild(_this);\n    } else {\n      var _this$parent2;\n\n      (_this$parent2 = _this.parent) === null || _this$parent2 === void 0 ? void 0 : _this$parent2.updateTickerState();\n    }\n  };\n\n  this.paused = function () {\n    var v = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n    _this.pausedState = v;\n\n    _this.setStartTimeOrMoment();\n\n    _this.play(v);\n  };\n\n  this.reverse = function (v) {\n    _this.reverseState = v;\n\n    _this.setStartTimeOrMoment();\n\n    _this.play(_this.pausedState);\n  };\n\n  this.goto = function ($moment, paused) {\n    var moment = $moment - _this.regionStartTime;\n    _this.startTime = Ticker.time;\n    _this.startMoment = moment > _this.totalTime ? _this.totalTime : moment;\n    _this.progressMoment = _this.startMoment;\n    _this.progressTime = moment;\n\n    _this.play(_this.pausedState);\n\n    _this.reRenderCall();\n\n    if (!!paused !== _this.pausedState) {\n      _this.paused(paused);\n    }\n  };\n\n  this.kill = function (index) {\n    if (typeof index === 'number') {\n      _this.paused();\n\n      delete _this.children[index];\n\n      _this.setTotalTime();\n\n      _this.paused(false);\n    } else {\n      _this.children = [];\n    }\n  };\n\n  this.onChange = function (e) {\n    e.timelineMoment = _this.progressMoment;\n\n    _this.onChangeChild(e);\n  };\n\n  this.render = function (_ref) {\n    var time = _ref.time,\n        elapsed = _ref.elapsed;\n    var fps = elapsed || Ticker.frameFPS || 0;\n    var totalTime = _this.totalTime,\n        totalTimeRegion = _this.totalTimeRegion,\n        childTotalTime = _this.childTotalTime,\n        childRegionTotalTime = _this.childRegionTotalTime,\n        children = _this.children,\n        props = _this.props,\n        startTime = _this.startTime,\n        reverseState = _this.reverseState,\n        pausedState = _this.pausedState,\n        startMoment = _this.startMoment,\n        onChangeTimeline = _this.onChangeTimeline,\n        parent = _this.parent,\n        root = _this.root,\n        prevMoment = _this.prevMoment,\n        regionStartTime = _this.regionStartTime;\n    var _props$repeatDelay = props.repeatDelay,\n        repeatDelay = _props$repeatDelay === void 0 ? 0 : _props$repeatDelay,\n        yoyo = props.yoyo,\n        delay = props.delay;\n    var _props$repeat = props.repeat,\n        repeat = _props$repeat === void 0 ? 0 : _props$repeat;\n    repeat = repeat === -1 ? Number.MAX_VALUE : repeat;\n    var t = time - startTime - delay;\n    var m = reverseState ? startMoment - t : t + startMoment;\n\n    if (m < -fps) {\n      return;\n    }\n\n    var moment = m < 0 ? 0 : m;\n    moment = moment > totalTime ? totalTime : moment;\n    moment = startMoment < regionStartTime ? m : moment;\n    moment = startMoment > totalTimeRegion ? startMoment : moment;\n    var repeatNum = repeat ? Math.floor(moment / (childRegionTotalTime + repeatDelay)) : 0;\n    repeatNum = repeat && repeatNum > repeat ? repeat : repeatNum;\n    var tweenMoment = moment - (childRegionTotalTime + repeatDelay) * repeatNum;\n    var yoyoReverse = !!(yoyo && repeatNum % 2);\n    tweenMoment = yoyoReverse ? childRegionTotalTime - tweenMoment : tweenMoment;\n    tweenMoment = regionStartTime + tweenMoment;\n    var reverse = reverseState ? !yoyoReverse : yoyoReverse;\n    _this.mode = 'onTimelineUpdate';\n\n    if (typeof prevMoment !== 'number') {\n      _this.mode = 'onTimelineStart';\n    }\n\n    if (moment >= totalTimeRegion - delay && typeof prevMoment === 'number') {\n      _this.mode = 'onTimelineComplete';\n    }\n\n    if (repeatNum !== _this.repeatNum) {\n      _this.mode = 'onTimelineRepeat'; // 补帧状态;\n\n      if (moment > _this.childTotalTime * repeatNum && moment < _this.childTotalTime * repeatNum + fps) {\n        for (var i = children.length - 1; i >= 0; i--) {\n          var item = children[i];\n\n          if (!reverse) {\n            item.prevMoment = undefined;\n          }\n\n          item.render({\n            moment: reverse ? item.totalTime : 0,\n            fps: fps\n          });\n        }\n\n        onChangeTimeline({\n          moment: moment,\n          totalTime: totalTime,\n          repeat: repeatNum,\n          mode: _this.mode,\n          targets: root.targets\n        });\n        _this.mode = 'onTimelineUpdate';\n      }\n    }\n\n    if (repeat) {\n      _this.repeatNum = repeatNum;\n    }\n\n    _this.progressMoment = moment;\n    _this.prevMoment = moment;\n    _this.progressTime = t; // children.forEach(item => {\n\n    for (var _i = 0; _i < children.length; _i++) {\n      var _item = children[_i];\n      /* if (!item) {\n        return;\n      } */\n\n      var duration = _item.totalTime + _item.appearTo;\n      var tweenTime = tweenMoment >= _item.appearTo - fps && tweenMoment < duration + fps; // 过帧补\n\n      if (_item.mode !== 'onComplete' && tweenMoment > duration + fps && !yoyoReverse) {\n        // console.log('结束', i, item.totalTime, repeatNum, yoyoReverse);\n        _item.render({\n          moment: _item.totalTime,\n          fps: fps\n        });\n\n        _item.prevMoment = undefined;\n      }\n\n      if (tweenMoment < _item.appearTo - fps && _item.mode && _item.mode !== 'onStart') {\n        // console.log('重置', i, item.appearTo, tweenMoment, item.prevMoment, item.mode);\n        _item.render({\n          moment: _item.appearTo,\n          fps: fps,\n          silence: true\n        });\n\n        _item.prevMoment = undefined;\n        _item.mode = undefined;\n      }\n\n      if (tweenTime) {\n        var _t = tweenMoment < 0 ? 0 : tweenMoment;\n\n        if (tweenMoment > duration && _item.mode === 'onComplete' && !yoyoReverse) {\n          return;\n        }\n\n        _t = tweenMoment > duration ? duration : tweenMoment; // item.parentBackwards = reverse;\n\n        _item.render({\n          moment: _t - _item.appearTo,\n          fps: fps\n        });\n\n        if (!duration) {\n          // console.log('set 状态补帧', i);\n          _item.render({\n            moment: _item.totalTime,\n            fps: fps,\n            render: true\n          });\n\n          _item.prevMoment = undefined;\n        }\n      }\n    } // });\n\n\n    onChangeTimeline({\n      moment: moment,\n      totalTime: totalTime,\n      repeat: repeatNum,\n      mode: _this.mode,\n      targets: root.targets\n    });\n\n    if (pausedState || totalTimeRegion && m + delay >= totalTimeRegion && !reverseState || reverseState && m + delay <= 0) {\n      parent.removeChild(_this);\n    }\n  };\n\n  var _this$props3 = this.props,\n      paused = _this$props3.paused,\n      reverse = _this$props3.reverse;\n  this.reverseState = reverse;\n  this.pausedState = paused;\n  this.regionStartTime = props.regionStartTime || 0;\n  this.regionEndTime = props.regionEndTime;\n};\n\nexport { AnimateGroup as default };","map":{"version":3,"sources":["/Users/stewardsun/Desktop/技术栈/React项目/Boss Recruitment/bob-recruitment-client/node_modules/tween-one/es/animate/animate.js"],"names":["_classCallCheck","Ticker","Element","dataToArray","getAnimatePos","AnimateGroup","props","_this","children","totalTime","totalTimeRegion","childTotalTime","childRegionTotalTime","progressTime","progressMoment","startMoment","startTime","repeatNum","mode","regionStartTime","init","_this$props","reverse","animation","moment","animateArray","i","length","item","type","duration","animate","index","pos","appearTo","addChild","render","time","elapsed","goto","play","parent","root","indexOf","push","setTotalTime","itemTime","regionEndTime","_this$props2","_this$props2$repeat","repeat","_this$props2$repeatDe","repeatDelay","delay","Number","MAX_VALUE","setStartTimeOrMoment","start","reRenderCall","frameFPS","v","_this$parent","_this$parent2","updateTickerState","paused","arguments","undefined","pausedState","reverseState","$moment","kill","onChange","e","timelineMoment","onChangeChild","_ref","fps","onChangeTimeline","prevMoment","_props$repeatDelay","yoyo","_props$repeat","t","m","Math","floor","tweenMoment","yoyoReverse","targets","_i","_item","tweenTime","silence","_t","removeChild","_this$props3","default"],"mappings":"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","sourcesContent":["import _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport Ticker from './ticker';\nimport Element from './animateElement';\nimport { dataToArray, getAnimatePos } from '../utils';\n\nvar AnimateGroup = function AnimateGroup(props) {\n  var _this = this;\n\n  _classCallCheck(this, AnimateGroup);\n\n  this.props = props;\n  this.children = [];\n  this.totalTime = 0;\n  this.totalTimeRegion = 0;\n  this.childTotalTime = 0;\n  this.childRegionTotalTime = 0;\n  this.progressTime = 0;\n  this.progressMoment = -1;\n  this.startMoment = 0;\n  this.startTime = 0;\n  this.repeatNum = 0;\n  this.mode = 'onTimelineStart';\n  this.regionStartTime = 0;\n\n  this.init = function () {\n    var _this$props = _this.props,\n        reverse = _this$props.reverse,\n        animation = _this$props.animation,\n        moment = _this$props.moment;\n    var animateArray = dataToArray(animation);\n\n    for (var i = 0; i < animateArray.length; i++) {\n      var item = animateArray[i];\n\n      if (item.type === 'set') {\n        item.duration = 0;\n      } //animateArray.forEach((item: any, i: number) => {\n\n\n      var animate = new Element(item);\n      animate.index = i;\n      var pos = i ? getAnimatePos(item, animateArray[i - 1]) : 0;\n      item.appearTo = pos;\n      animate.appearTo = pos;\n\n      _this.addChild(animate); //});\n\n    } // 注册\n\n\n    _this.render({\n      time: (reverse ? _this.totalTime : 0) + _this.startTime,\n      elapsed: 16.67\n    });\n\n    if (!_this.totalTime) {\n      _this.render({\n        time: (reverse ? _this.totalTime : 0) + _this.startTime,\n        elapsed: 16.67\n      });\n    }\n\n    if (moment) {\n      _this.goto(moment);\n    } else {\n      _this.play();\n    }\n  };\n\n  this.addChild = function (animate) {\n    animate.parent = _this;\n    animate.root = _this.root;\n\n    if (_this.children.indexOf(animate) === -1) {\n      _this.children.push(animate);\n\n      _this.setTotalTime();\n    }\n  };\n\n  this.setTotalTime = function () {\n    _this.childTotalTime = 0;\n    _this.childRegionTotalTime = 0;\n\n    for (var i = 0; i < _this.children.length; i++) {\n      var item = _this.children[i];\n\n      if (item.appearTo !== _this.childTotalTime) {\n        var itemTime = item.appearTo + item.totalTime;\n\n        if (itemTime > _this.childTotalTime) {\n          _this.childTotalTime = itemTime;\n          _this.childRegionTotalTime = itemTime;\n        }\n      } else {\n        _this.childTotalTime += item.totalTime;\n        _this.childRegionTotalTime += item.totalTime;\n      }\n    }\n\n    if (_this.regionStartTime) {\n      _this.childRegionTotalTime -= _this.regionStartTime;\n    }\n\n    if (_this.regionEndTime) {\n      _this.childRegionTotalTime = _this.regionEndTime - _this.regionStartTime;\n    }\n\n    var _this$props2 = _this.props,\n        _this$props2$repeat = _this$props2.repeat,\n        repeat = _this$props2$repeat === void 0 ? 0 : _this$props2$repeat,\n        _this$props2$repeatDe = _this$props2.repeatDelay,\n        repeatDelay = _this$props2$repeatDe === void 0 ? 0 : _this$props2$repeatDe,\n        delay = _this$props2.delay;\n    _this.totalTime = repeat === -1 ? Number.MAX_VALUE : delay + _this.childTotalTime * (repeat + 1) + repeatDelay * repeat;\n    _this.totalTimeRegion = repeat === -1 ? Number.MAX_VALUE : delay + _this.childRegionTotalTime * (repeat + 1) + repeatDelay * repeat;\n  };\n\n  this.setStartTimeOrMoment = function (start) {\n    _this.startTime = Ticker.time;\n    _this.startMoment = start || _this.progressMoment;\n  };\n\n  this.reRenderCall = function () {\n    _this.render({\n      time: _this.startTime,\n      elapsed: Ticker.elapsed || Ticker.frameFPS\n    });\n  };\n\n  this.play = function (v) {\n    if (!v) {\n      var _this$parent;\n\n      (_this$parent = _this.parent) === null || _this$parent === void 0 ? void 0 : _this$parent.addChild(_this);\n    } else {\n      var _this$parent2;\n\n      (_this$parent2 = _this.parent) === null || _this$parent2 === void 0 ? void 0 : _this$parent2.updateTickerState();\n    }\n  };\n\n  this.paused = function () {\n    var v = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n    _this.pausedState = v;\n\n    _this.setStartTimeOrMoment();\n\n    _this.play(v);\n  };\n\n  this.reverse = function (v) {\n    _this.reverseState = v;\n\n    _this.setStartTimeOrMoment();\n\n    _this.play(_this.pausedState);\n  };\n\n  this.goto = function ($moment, paused) {\n    var moment = $moment - _this.regionStartTime;\n    _this.startTime = Ticker.time;\n    _this.startMoment = moment > _this.totalTime ? _this.totalTime : moment;\n    _this.progressMoment = _this.startMoment;\n    _this.progressTime = moment;\n\n    _this.play(_this.pausedState);\n\n    _this.reRenderCall();\n\n    if (!!paused !== _this.pausedState) {\n      _this.paused(paused);\n    }\n  };\n\n  this.kill = function (index) {\n    if (typeof index === 'number') {\n      _this.paused();\n\n      delete _this.children[index];\n\n      _this.setTotalTime();\n\n      _this.paused(false);\n    } else {\n      _this.children = [];\n    }\n  };\n\n  this.onChange = function (e) {\n    e.timelineMoment = _this.progressMoment;\n\n    _this.onChangeChild(e);\n  };\n\n  this.render = function (_ref) {\n    var time = _ref.time,\n        elapsed = _ref.elapsed;\n    var fps = elapsed || Ticker.frameFPS || 0;\n    var totalTime = _this.totalTime,\n        totalTimeRegion = _this.totalTimeRegion,\n        childTotalTime = _this.childTotalTime,\n        childRegionTotalTime = _this.childRegionTotalTime,\n        children = _this.children,\n        props = _this.props,\n        startTime = _this.startTime,\n        reverseState = _this.reverseState,\n        pausedState = _this.pausedState,\n        startMoment = _this.startMoment,\n        onChangeTimeline = _this.onChangeTimeline,\n        parent = _this.parent,\n        root = _this.root,\n        prevMoment = _this.prevMoment,\n        regionStartTime = _this.regionStartTime;\n    var _props$repeatDelay = props.repeatDelay,\n        repeatDelay = _props$repeatDelay === void 0 ? 0 : _props$repeatDelay,\n        yoyo = props.yoyo,\n        delay = props.delay;\n    var _props$repeat = props.repeat,\n        repeat = _props$repeat === void 0 ? 0 : _props$repeat;\n    repeat = repeat === -1 ? Number.MAX_VALUE : repeat;\n    var t = time - startTime - delay;\n    var m = reverseState ? startMoment - t : t + startMoment;\n\n    if (m < -fps) {\n      return;\n    }\n\n    var moment = m < 0 ? 0 : m;\n    moment = moment > totalTime ? totalTime : moment;\n    moment = startMoment < regionStartTime ? m : moment;\n    moment = startMoment > totalTimeRegion ? startMoment : moment;\n    var repeatNum = repeat ? Math.floor(moment / (childRegionTotalTime + repeatDelay)) : 0;\n    repeatNum = repeat && repeatNum > repeat ? repeat : repeatNum;\n    var tweenMoment = moment - (childRegionTotalTime + repeatDelay) * repeatNum;\n    var yoyoReverse = !!(yoyo && repeatNum % 2);\n    tweenMoment = yoyoReverse ? childRegionTotalTime - tweenMoment : tweenMoment;\n    tweenMoment = regionStartTime + tweenMoment;\n    var reverse = reverseState ? !yoyoReverse : yoyoReverse;\n    _this.mode = 'onTimelineUpdate';\n\n    if (typeof prevMoment !== 'number') {\n      _this.mode = 'onTimelineStart';\n    }\n\n    if (moment >= totalTimeRegion - delay && typeof prevMoment === 'number') {\n      _this.mode = 'onTimelineComplete';\n    }\n\n    if (repeatNum !== _this.repeatNum) {\n      _this.mode = 'onTimelineRepeat'; // 补帧状态;\n\n      if (moment > _this.childTotalTime * repeatNum && moment < _this.childTotalTime * repeatNum + fps) {\n        for (var i = children.length - 1; i >= 0; i--) {\n          var item = children[i];\n\n          if (!reverse) {\n            item.prevMoment = undefined;\n          }\n\n          item.render({\n            moment: reverse ? item.totalTime : 0,\n            fps: fps\n          });\n        }\n\n        onChangeTimeline({\n          moment: moment,\n          totalTime: totalTime,\n          repeat: repeatNum,\n          mode: _this.mode,\n          targets: root.targets\n        });\n        _this.mode = 'onTimelineUpdate';\n      }\n    }\n\n    if (repeat) {\n      _this.repeatNum = repeatNum;\n    }\n\n    _this.progressMoment = moment;\n    _this.prevMoment = moment;\n    _this.progressTime = t; // children.forEach(item => {\n\n    for (var _i = 0; _i < children.length; _i++) {\n      var _item = children[_i];\n      /* if (!item) {\n        return;\n      } */\n\n      var duration = _item.totalTime + _item.appearTo;\n      var tweenTime = tweenMoment >= _item.appearTo - fps && tweenMoment < duration + fps; // 过帧补\n\n      if (_item.mode !== 'onComplete' && tweenMoment > duration + fps && !yoyoReverse) {\n        // console.log('结束', i, item.totalTime, repeatNum, yoyoReverse);\n        _item.render({\n          moment: _item.totalTime,\n          fps: fps\n        });\n\n        _item.prevMoment = undefined;\n      }\n\n      if (tweenMoment < _item.appearTo - fps && _item.mode && _item.mode !== 'onStart') {\n        // console.log('重置', i, item.appearTo, tweenMoment, item.prevMoment, item.mode);\n        _item.render({\n          moment: _item.appearTo,\n          fps: fps,\n          silence: true\n        });\n\n        _item.prevMoment = undefined;\n        _item.mode = undefined;\n      }\n\n      if (tweenTime) {\n        var _t = tweenMoment < 0 ? 0 : tweenMoment;\n\n        if (tweenMoment > duration && _item.mode === 'onComplete' && !yoyoReverse) {\n          return;\n        }\n\n        _t = tweenMoment > duration ? duration : tweenMoment; // item.parentBackwards = reverse;\n\n        _item.render({\n          moment: _t - _item.appearTo,\n          fps: fps\n        });\n\n        if (!duration) {\n          // console.log('set 状态补帧', i);\n          _item.render({\n            moment: _item.totalTime,\n            fps: fps,\n            render: true\n          });\n\n          _item.prevMoment = undefined;\n        }\n      }\n    } // });\n\n\n    onChangeTimeline({\n      moment: moment,\n      totalTime: totalTime,\n      repeat: repeatNum,\n      mode: _this.mode,\n      targets: root.targets\n    });\n\n    if (pausedState || totalTimeRegion && m + delay >= totalTimeRegion && !reverseState || reverseState && m + delay <= 0) {\n      parent.removeChild(_this);\n    }\n  };\n\n  var _this$props3 = this.props,\n      paused = _this$props3.paused,\n      reverse = _this$props3.reverse;\n  this.reverseState = reverse;\n  this.pausedState = paused;\n  this.regionStartTime = props.regionStartTime || 0;\n  this.regionEndTime = props.regionEndTime;\n};\n\nexport { AnimateGroup as default };"]},"metadata":{},"sourceType":"module"}