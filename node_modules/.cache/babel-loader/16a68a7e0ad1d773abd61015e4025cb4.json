{"ast":null,"code":"import \"antd-mobile/es/grid/style\";\nimport _Grid from \"antd-mobile/es/grid\";\nimport \"antd-mobile/es/input-item/style\";\nimport _InputItem from \"antd-mobile/es/input-item\";\nimport \"antd-mobile/es/nav-bar/style\";\nimport _NavBar from \"antd-mobile/es/nav-bar\";\nimport \"antd-mobile/es/list/style\";\nimport _List from \"antd-mobile/es/list\";\nvar _jsxFileName = \"/Users/stewardsun/Desktop/\\u6280\\u672F\\u6808/React\\u9879\\u76EE/Boss Recruitment/bob-recruitment-client/src/containers/chat/chat.jsx\";\nimport React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport { sendMsg } from '../../redux/actions';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Item = _List.Item;\n\nclass Chat extends Component {\n  constructor() {\n    super(...arguments);\n    this.state = {\n      content: '',\n      isShow: false // show emoji list or not\n\n    };\n\n    this.handleSend = () => {\n      const from = this.props.user._id;\n      const to = this.props.match.params.userId;\n      const content = this.state.content.trim(); // send request send msg\n\n      if (content) {\n        this.props.sendMsg({\n          from,\n          to,\n          content\n        });\n      } // clear input data\n\n\n      this.setState({\n        content: '',\n        isShow: false\n      });\n    };\n\n    this.toggleShow = () => {\n      const isShow = !this.state.isShow;\n      this.setState({\n        isShow\n      });\n\n      if (isShow) {\n        // fix bug, this bug is anti-mobile component internal bug, just fix it\n        setTimeout(() => {\n          window.dispatchEvent(new Event('resize'));\n        }, 0);\n      }\n    };\n  }\n\n  // first render before\n  UNSAFE_componentWillMount() {\n    // init emoji list data\n    const emojis = ['😀', '😃', '😄', '😁', '😆', '😅', '🤣', '😂', '🙂', '🙃', '😉', '😊', '😇', '🥰', '😍', '🤩', '😘', '😗', '😚', '😙', '🥲', '😋', '😛', '😜', '🤪', '😝', '🤑', '🤗', '🤭', '🤫', '🤔', '🤐', '🤨', '😐', '😑', '😶', '😶‍🌫️', '😏', '😒', '🙄', '😬', '😮‍💨', '🤥', '😌', '😔', '😪', '🤤', '😴', '😷', '🤒', '🤕', '🤢', '🤮', '🤧', '🥵', '🥶'];\n    this.emojis = emojis.map(emoji => ({\n      text: emoji\n    }));\n  }\n\n  render() {\n    const {\n      user\n    } = this.props;\n    const {\n      users,\n      chatMsgs\n    } = this.props.chat; // filter chatMsgs\n\n    const my_id = user._id;\n\n    if (!users[my_id]) {\n      // control async, async sometimes no data\n      return null;\n    }\n\n    const target_id = this.props.match.params.userId;\n    const chatId = [my_id, target_id].sort().join('_');\n    const msgs = chatMsgs.filter(msg => msg.chat_id === chatId); // get target user header\n\n    const target_header = users[target_id].header;\n    const target_icon = target_header ? require(`../../assets/img/${target_header}.png`).default : null;\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      id: \"chat-page\",\n      children: [/*#__PURE__*/_jsxDEV(_NavBar, {\n        className: \"sticky-header\",\n        children: users[target_id].username\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(_List, {\n        children: msgs.map(msg => {\n          if (my_id === msg.to) {\n            // msg from the other\n            return /*#__PURE__*/_jsxDEV(Item, {\n              thumb: target_icon,\n              children: msg.content\n            }, msg._id, false, {\n              fileName: _jsxFileName,\n              lineNumber: 74,\n              columnNumber: 37\n            }, this);\n          } else {\n            return /*#__PURE__*/_jsxDEV(Item, {\n              className: \"chat-me\",\n              extra: \"Me\",\n              children: msg.content\n            }, msg._id, false, {\n              fileName: _jsxFileName,\n              lineNumber: 80,\n              columnNumber: 37\n            }, this);\n          }\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"am-tab-bar\",\n        children: [/*#__PURE__*/_jsxDEV(_InputItem, {\n          placeholder: \"Please input your words\",\n          value: this.state.content,\n          onChange: val => this.setState({\n            content: val\n          }),\n          onFocus: () => this.setState({\n            isShow: false\n          }),\n          extra: /*#__PURE__*/_jsxDEV(\"span\", {\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              onClick: this.toggleShow,\n              style: {\n                marginRight: 5\n              },\n              children: \"\\uD83D\\uDE00\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 96,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              onClick: this.handleSend,\n              children: \"Send\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 97,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 95,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 89,\n          columnNumber: 21\n        }, this), this.state.isShow ? /*#__PURE__*/_jsxDEV(_Grid, {\n          data: this.emojis,\n          columnNum: 8,\n          carouselMaxRow: 4,\n          isCarousel: true,\n          onClick: item => {\n            this.setState({\n              content: this.state.content + item.text\n            });\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 102,\n          columnNumber: 25\n        }, this) : null]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 13\n    }, this);\n  }\n\n}\n\nexport default connect(state => ({\n  user: state.user1,\n  chat: state.chat1\n}), {\n  sendMsg\n})(Chat);","map":{"version":3,"sources":["/Users/stewardsun/Desktop/技术栈/React项目/Boss Recruitment/bob-recruitment-client/src/containers/chat/chat.jsx"],"names":["React","Component","connect","sendMsg","Item","Chat","state","content","isShow","handleSend","from","props","user","_id","to","match","params","userId","trim","setState","toggleShow","setTimeout","window","dispatchEvent","Event","UNSAFE_componentWillMount","emojis","map","emoji","text","render","users","chatMsgs","chat","my_id","target_id","chatId","sort","join","msgs","filter","msg","chat_id","target_header","header","target_icon","require","default","username","val","marginRight","item","user1","chat1"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport { NavBar, List, InputItem, Grid } from 'antd-mobile'\nimport { connect } from 'react-redux'\nimport { sendMsg } from '../../redux/actions'\nconst Item = List.Item\nclass Chat extends Component {\n\n    state = {\n        content: '',\n        isShow: false // show emoji list or not\n    }\n\n    // first render before\n    UNSAFE_componentWillMount() {\n        // init emoji list data\n        const emojis = [\n            '😀', '😃', '😄', '😁', '😆', '😅', '🤣', '😂',\n            '🙂', '🙃', '😉', '😊', '😇', '🥰', '😍', '🤩',\n            '😘', '😗', '😚', '😙', '🥲', '😋', '😛', '😜',\n            '🤪', '😝', '🤑', '🤗', '🤭', '🤫', '🤔', '🤐',\n            '🤨', '😐', '😑', '😶', '😶‍🌫️', '😏', '😒', '🙄',\n            '😬', '😮‍💨', '🤥', '😌', '😔', '😪', '🤤', '😴',\n            '😷', '🤒', '🤕', '🤢', '🤮', '🤧', '🥵', '🥶'];\n        this.emojis = emojis.map(emoji => ({ text: emoji }));\n    }\n\n    handleSend = () => {\n        const from = this.props.user._id;\n        const to = this.props.match.params.userId;\n        const content = this.state.content.trim();\n        // send request send msg\n        if (content) {\n            this.props.sendMsg({ from, to, content });\n        }\n        // clear input data\n        this.setState({ content: '', isShow: false });\n    }\n\n    toggleShow = () => {\n        const isShow = !this.state.isShow;\n        this.setState({ isShow });\n        if (isShow) {\n            // fix bug, this bug is anti-mobile component internal bug, just fix it\n            setTimeout(() => {\n                window.dispatchEvent(new Event('resize'))\n            }, 0)\n        }\n    }\n\n    render() {\n        const { user } = this.props;\n        const { users, chatMsgs } = this.props.chat;\n        // filter chatMsgs\n        const my_id = user._id;\n        if (!users[my_id]) { // control async, async sometimes no data\n            return null;\n        }\n        const target_id = this.props.match.params.userId;\n        const chatId = [my_id, target_id].sort().join('_');\n        const msgs = chatMsgs.filter(msg => msg.chat_id === chatId);\n\n        // get target user header\n        const target_header = users[target_id].header;\n        const target_icon = target_header ? require(`../../assets/img/${target_header}.png`).default : null;\n\n        return (\n            <div id='chat-page'>\n                <NavBar className='sticky-header'>{users[target_id].username}</NavBar>\n                <List>\n                    {\n                        msgs.map(msg => {\n                            if (my_id === msg.to) { // msg from the other\n                                return (\n                                    <Item key={msg._id} thumb={target_icon}>\n                                        {msg.content}\n                                    </Item>\n                                )\n                            } else {\n                                return (\n                                    <Item key={msg._id} className='chat-me' extra='Me'>\n                                        {msg.content}\n                                    </Item>\n                                )\n                            }\n                        })\n                    }\n                </List>\n                <div className='am-tab-bar'>\n                    <InputItem\n                        placeholder=\"Please input your words\"\n                        value={this.state.content}\n                        onChange={val => this.setState({ content: val })}\n                        onFocus={() => this.setState({ isShow: false })}\n                        extra={\n                            <span>\n                                <span onClick={this.toggleShow} style={{ marginRight: 5 }}>😀</span>\n                                <span onClick={this.handleSend}>Send</span>\n                            </span>\n                        }\n                    />\n                    {this.state.isShow ? (\n                        <Grid\n                            data={this.emojis}\n                            columnNum={8}\n                            carouselMaxRow={4}\n                            isCarousel={true}\n                            onClick={(item) => {\n                                this.setState({ content: this.state.content + item.text })\n                            }}\n                        />\n                    ) : null}\n\n                </div>\n            </div>\n        )\n    }\n}\n\nexport default connect(\n    state => ({ user: state.user1, chat: state.chat1 }),\n    { sendMsg }\n)(Chat)"]},"metadata":{},"sourceType":"module"}