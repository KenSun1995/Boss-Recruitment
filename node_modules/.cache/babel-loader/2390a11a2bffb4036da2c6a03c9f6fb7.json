{"ast":null,"code":"import _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\n/**\n * Animate\n * 动画处理器\n * 滤境管理\n *\n * Animate 时间组成\n * [1.---delay---][1.---duration---][1.---repeatDelay---][2.---duration---]\n * repeatDelay 跟在时间后面；\n * 总时间 totalTime: delay + duration * (repeat + 1) + repeatDelay * repeat;\n *\n * 回调事件处理\n * repeat = 0:\n * [---delay---][---onStart(0)---][---onUpdate(duration)---][---onComplete(totalTime)---]\n * repeat = 2:\n * 1.[---delay---][---onStart(0)---][---onUpdate(duration)---][---repeatDelay---]\n * 2.[---onRepeat(0)---][---onUpdate(duration)---][---repeatDelay---]\n * 3.[---onRepeat(0)---][---onUpdate( duration)---][---onComplete(totalTime)---]\n *\n */\n\nimport { initAnimProps, getDefaultStart, getValue, flatArray } from '../utils';\nimport ease from './ease';\nimport { Plugins } from '../';\n\nvar Element = /*#__PURE__*/function () {\n  function Element(item) {\n    var _this = this;\n\n    _classCallCheck(this, Element);\n\n    this.item = item;\n    this.vars = {};\n    this.startAt = {};\n    this.appearTo = 0;\n    this.props = {};\n    this.repeatNum = 0;\n\n    this.setEase = function (e) {\n      if (typeof e === 'function') {\n        _this.easing = e;\n        return;\n      } else if (e.match(/,/g)) {\n        _this.easing = ease.path(e);\n        return;\n      }\n\n      _this.easing = ease[e];\n    };\n\n    this.getTotalTime = function () {\n      var _this$props = _this.props,\n          _this$props$duration = _this$props.duration,\n          duration = _this$props$duration === void 0 ? 450 : _this$props$duration,\n          _this$props$delay = _this$props.delay,\n          delay = _this$props$delay === void 0 ? 0 : _this$props$delay,\n          _this$props$repeat = _this$props.repeat,\n          repeat = _this$props$repeat === void 0 ? 0 : _this$props$repeat,\n          _this$props$repeatDel = _this$props.repeatDelay,\n          repeatDelay = _this$props$repeatDel === void 0 ? 0 : _this$props$repeatDel;\n      return repeat === -1 ? Number.MAX_VALUE : delay + duration * (repeat + 1) + repeatDelay * repeat;\n    };\n\n    this.getEaseToRatio = function (r, isFrom) {\n      var _this$props$ease = _this.props.ease,\n          ease = _this$props$ease === void 0 ? '' : _this$props$ease;\n      return (r === 0 || r === 1) && !(typeof ease === 'function' || ease.match(/,/g)) ? r : _this.easing(isFrom ? 1 - r : r, isFrom ? 1 : 0, isFrom ? 0 : 1, 1);\n    };\n\n    this.setRatioToVars = function (ratio) {\n      var vars = _this.vars,\n          root = _this.root;\n\n      for (var i = 0; i < root.targets.length; i++) {\n        if (!root.targets[i]) {\n          continue;\n        } // root.targets.forEach((_, i) => {\n\n\n        for (var key in vars) {\n          // Object.keys(vars).forEach((key: string) => {\n          var _item = vars[key];\n\n          if (_item.plugins) {\n            if (key === 'PathMotion') {\n              // pathMotion 的属性与 style 通用。不需新增；\n              root.vars[i].style = _item.plugins[i].render(ratio);\n            } else {\n              root.vars[i][key] = _item.plugins[i].render(ratio);\n            }\n\n            continue;\n          }\n\n          var endVars = _item.vars,\n              count = _item.count,\n              unit = _item.unit;\n          var startVars = _this.start[i][key];\n          root.vars[i][key] = getValue(startVars, endVars, ratio, count, unit); //});\n        } //});\n\n      }\n    };\n\n    this.onRegisterAnimate = function () {\n      _this.register = true;\n      var root = _this.root,\n          parent = _this.parent,\n          startAt = _this.startAt;\n      var start = [];\n\n      for (var i = 0; i < root.targets.length; i++) {\n        var target = root.targets[i];\n        var s = {};\n\n        for (var key in _this.vars) {\n          var cItem = _this.vars[key];\n\n          if (cItem.plugins) {\n            var plugin = new Plugins[cItem.array ? 'ArrayPlugin' : key](cItem.value, key);\n            plugin.target = target;\n            plugin.root = root;\n            plugin.parent = parent;\n            plugin.targetIndex = i;\n            plugin.tweenVars = root.vars[i];\n            plugin.index = _this.index;\n            plugin.startAt = _this.startAt;\n            s[key] = plugin.getAnimStart();\n            cItem.plugins.push(plugin);\n          } else {\n            var _ref, _startAt$key;\n\n            var startData = (_ref = (_startAt$key = startAt[key]) !== null && _startAt$key !== void 0 ? _startAt$key : // root.vars[i][key] ??\n            root.attr ? target.getAttribute(key) : target[key]) !== null && _ref !== void 0 ? _ref : getDefaultStart(key);\n            var unit = \"\".concat(startData).replace(/[^a-z|%]/g, '');\n            var varsUnit = cItem.unit;\n\n            if (unit && unit !== varsUnit) {\n              console.warn(\"Different units, start unit \".concat(unit, \", to value unit \").concat(varsUnit, \", remove start unit.\"));\n            }\n\n            s[key] = parseFloat(startData);\n          }\n        }\n\n        start.push(s);\n      }\n\n      _this.start = start;\n    };\n\n    this.overflowRatio = function (ratio) {\n      var r = ratio < 0 ? 0 : ratio;\n      var duration = _this.props.duration;\n      r = r > duration ? duration : r;\n      return r;\n    };\n\n    this.render = function (_ref2) {\n      var moment = _ref2.moment,\n          _ref2$fps = _ref2.fps,\n          fps = _ref2$fps === void 0 ? 0 : _ref2$fps,\n          silence = _ref2.silence,\n          render = _ref2.render;\n      var parent = _this.parent,\n          root = _this.root,\n          props = _this.props;\n      var targets = flatArray(root.targets);\n      var onChange = parent.onChange;\n      var _props$repeat = props.repeat,\n          repeat = _props$repeat === void 0 ? 0 : _props$repeat;\n      var _props$type = props.type,\n          type = _props$type === void 0 ? 'to' : _props$type,\n          _props$duration = props.duration,\n          duration = _props$duration === void 0 ? 450 : _props$duration,\n          _props$delay = props.delay,\n          delay = _props$delay === void 0 ? 0 : _props$delay,\n          _props$repeatDelay = props.repeatDelay,\n          repeatDelay = _props$repeatDelay === void 0 ? 0 : _props$repeatDelay,\n          yoyo = props.yoyo;\n      repeat = repeat === -1 ? Number.MAX_VALUE : repeat;\n      var ratio = moment - delay; // const totalTime = duration + delay;\n\n      var repeatNum = Math.floor(ratio / (duration + repeatDelay)) || 0;\n      repeatNum = repeatNum > repeat ? repeat : repeatNum;\n      repeatNum = repeatNum < 0 ? 0 : repeatNum;\n      ratio = ratio - (duration + repeatDelay) * repeatNum;\n      /**\n       * 反向播放 isFrom 与 yoyoReverse 的区别\n       * 反向播放: isFrom\n       * [---delay---][---isFrom duration---]\n       * yoyo\n       * [---duration---][---delay---]\n       * backwards\n       * 两个都为 true 时为 false;\n       */\n\n      var yoyoReverse = !!(yoyo && repeatNum % 2);\n      var isFrom = type === 'from';\n      var backwards = yoyoReverse && isFrom ? false : yoyoReverse || isFrom;\n      ratio = backwards ? duration - ratio : ratio;\n      var fromDelay = isFrom ? 0 : delay;\n      var r = backwards ? 1 : 0; // 0 进入时的注册\n\n      if (!_this.register && moment >= fromDelay) {\n        _this.onRegisterAnimate(); // 时间超出当前动画时间的处理\n\n\n        if (backwards && ratio <= 0 || !backwards && ratio >= duration && duration) {\n          // this.mode = 'onComplete';\n          _this.prevMoment = moment;\n          r = backwards ? 0 : 1;\n        }\n\n        _this.setRatioToVars(r); // 初始注册，改变外部 vars;\n\n\n        onChange({\n          index: _this.index,\n          vars: root.vars\n        });\n      }\n\n      if (_this.register && moment > delay - fps && moment < _this.totalTime + fps) {\n        ratio = _this.overflowRatio(ratio);\n        r = backwards ? 1 : 0;\n\n        if (moment >= _this.totalTime && _this.mode !== 'onComplete' && _this.prevMoment !== undefined || _this.prevMoment === undefined && moment >= _this.totalTime && duration) {\n          r = backwards ? 0 : 1;\n          _this.mode = 'onComplete';\n\n          if (_this.props.onComplete) {\n            _this.props.onComplete({\n              mode: _this.mode,\n              index: _this.index,\n              moment: ratio,\n              ratio: r,\n              targets: targets,\n              vars: flatArray(root.vars)\n            });\n          }\n        } else if (_this.prevMoment === undefined || moment <= 0 && moment > -fps && _this.mode !== 'onStart' && _this.prevMoment > moment) {\n          _this.mode = 'onStart';\n\n          if (_this.props.onStart) {\n            _this.props.onStart({\n              mode: _this.mode,\n              index: _this.index,\n              moment: ratio,\n              ratio: r,\n              targets: targets,\n              vars: flatArray(root.vars)\n            });\n          }\n        } else {\n          r = ratio / duration;\n          _this.mode = 'onUpdate';\n\n          if (_this.props.onUpdate) {\n            _this.props.onUpdate({\n              mode: _this.mode,\n              index: _this.index,\n              moment: ratio,\n              ratio: r,\n              targets: targets,\n              vars: flatArray(root.vars)\n            });\n          }\n        }\n\n        if (repeat && repeatNum !== _this.repeatNum && moment && _this.mode === 'onUpdate') {\n          _this.mode = 'onRepeat';\n\n          if (_this.props.onRepeat) {\n            _this.props.onRepeat({\n              mode: _this.mode,\n              index: _this.index,\n              moment: ratio,\n              ratio: r,\n              targets: targets,\n              vars: flatArray(_this.root.vars)\n            });\n          }\n        }\n\n        _this.setRatioToVars(_this.getEaseToRatio(r, isFrom));\n\n        if (repeat) {\n          _this.repeatNum = repeatNum;\n        }\n\n        var cb = {\n          mode: _this.mode,\n          moment: ratio,\n          repeat: repeatNum,\n          ratio: r,\n          targets: root.targets,\n          vars: root.vars,\n          index: _this.index\n        };\n\n        if (silence) {\n          cb.silence = silence;\n        }\n\n        if (render) {\n          cb.render = render;\n        }\n\n        onChange(cb);\n        _this.prevMoment = moment;\n      }\n    }; // delete item.appearTo;\n\n\n    this.startAt = item.startAt || {}; // delete item.startAt;\n\n    var props = {};\n\n    for (var k in item) {\n      var value = item[k];\n\n      if (!(k in initAnimProps)) {\n        var isArray = (Array.isArray(value) || k.match(/color|fill|stroke/i) || k.match(/shadow/i) || typeof value === 'string' && value.split(/[\\s|,]/).length > 1) && !(k in Plugins);\n\n        if (k in Plugins || isArray) {\n          this.vars[k] = {\n            value: value,\n            plugins: [],\n            array: isArray\n          };\n        } else {\n          var vars = parseFloat(value.toString().replace(/=/g, ''));\n          var unit = value.toString().replace(/[^a-z|%]/g, ''); // +=, -= 匹配\n\n          var count = value.toString().charAt(1) === '=' ? value.toString().replace(/[^\\+\\=|\\-\\=]/gi, '') : '';\n          var startUnit = (this.startAt[k] || 0).toString().replace(/[^a-z|%]/g, '');\n\n          if (unit !== startUnit && this.startAt[k] && this.startAt[k] !== getDefaultStart(k)) {\n            console.warn(\"Warning: animation vars(\".concat(value, \") units(\").concat(unit || 'px', \") are not equal to startAt(\").concat(startUnit || 'px', \").\"));\n          }\n\n          this.vars[k] = {\n            vars: vars,\n            unit: unit,\n            count: count\n          };\n        }\n      } else {\n        props[k] = value;\n      }\n    }\n\n    this.props = _objectSpread(_objectSpread({}, initAnimProps), props);\n    this.setEase(this.props.ease);\n  }\n\n  _createClass(Element, [{\n    key: \"totalTime\",\n    get: function get() {\n      return this.getTotalTime();\n    }\n  }]);\n\n  return Element;\n}();\n\nexport { Element as default };","map":{"version":3,"sources":["/Users/stewardsun/Desktop/技术栈/React项目/Boss Recruitment/bob-recruitment-client/node_modules/tween-one/es/animate/animateElement.js"],"names":["_objectSpread","_classCallCheck","_createClass","initAnimProps","getDefaultStart","getValue","flatArray","ease","Plugins","Element","item","_this","vars","startAt","appearTo","props","repeatNum","setEase","e","easing","match","path","getTotalTime","_this$props","_this$props$duration","duration","_this$props$delay","delay","_this$props$repeat","repeat","_this$props$repeatDel","repeatDelay","Number","MAX_VALUE","getEaseToRatio","r","isFrom","_this$props$ease","setRatioToVars","ratio","root","i","targets","length","key","_item","plugins","style","render","endVars","count","unit","startVars","start","onRegisterAnimate","register","parent","target","s","cItem","plugin","array","value","targetIndex","tweenVars","index","getAnimStart","push","_ref","_startAt$key","startData","attr","getAttribute","concat","replace","varsUnit","console","warn","parseFloat","overflowRatio","_ref2","moment","_ref2$fps","fps","silence","onChange","_props$repeat","_props$type","type","_props$duration","_props$delay","_props$repeatDelay","yoyo","Math","floor","yoyoReverse","backwards","fromDelay","prevMoment","totalTime","mode","undefined","onComplete","onStart","onUpdate","onRepeat","cb","k","isArray","Array","split","toString","charAt","startUnit","get","default"],"mappings":"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","sourcesContent":["import _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\n\n/**\n * Animate\n * 动画处理器\n * 滤境管理\n *\n * Animate 时间组成\n * [1.---delay---][1.---duration---][1.---repeatDelay---][2.---duration---]\n * repeatDelay 跟在时间后面；\n * 总时间 totalTime: delay + duration * (repeat + 1) + repeatDelay * repeat;\n *\n * 回调事件处理\n * repeat = 0:\n * [---delay---][---onStart(0)---][---onUpdate(duration)---][---onComplete(totalTime)---]\n * repeat = 2:\n * 1.[---delay---][---onStart(0)---][---onUpdate(duration)---][---repeatDelay---]\n * 2.[---onRepeat(0)---][---onUpdate(duration)---][---repeatDelay---]\n * 3.[---onRepeat(0)---][---onUpdate( duration)---][---onComplete(totalTime)---]\n *\n */\nimport { initAnimProps, getDefaultStart, getValue, flatArray } from '../utils';\nimport ease from './ease';\nimport { Plugins } from '../';\n\nvar Element = /*#__PURE__*/function () {\n  function Element(item) {\n    var _this = this;\n\n    _classCallCheck(this, Element);\n\n    this.item = item;\n    this.vars = {};\n    this.startAt = {};\n    this.appearTo = 0;\n    this.props = {};\n    this.repeatNum = 0;\n\n    this.setEase = function (e) {\n      if (typeof e === 'function') {\n        _this.easing = e;\n        return;\n      } else if (e.match(/,/g)) {\n        _this.easing = ease.path(e);\n        return;\n      }\n\n      _this.easing = ease[e];\n    };\n\n    this.getTotalTime = function () {\n      var _this$props = _this.props,\n          _this$props$duration = _this$props.duration,\n          duration = _this$props$duration === void 0 ? 450 : _this$props$duration,\n          _this$props$delay = _this$props.delay,\n          delay = _this$props$delay === void 0 ? 0 : _this$props$delay,\n          _this$props$repeat = _this$props.repeat,\n          repeat = _this$props$repeat === void 0 ? 0 : _this$props$repeat,\n          _this$props$repeatDel = _this$props.repeatDelay,\n          repeatDelay = _this$props$repeatDel === void 0 ? 0 : _this$props$repeatDel;\n      return repeat === -1 ? Number.MAX_VALUE : delay + duration * (repeat + 1) + repeatDelay * repeat;\n    };\n\n    this.getEaseToRatio = function (r, isFrom) {\n      var _this$props$ease = _this.props.ease,\n          ease = _this$props$ease === void 0 ? '' : _this$props$ease;\n      return (r === 0 || r === 1) && !(typeof ease === 'function' || ease.match(/,/g)) ? r : _this.easing(isFrom ? 1 - r : r, isFrom ? 1 : 0, isFrom ? 0 : 1, 1);\n    };\n\n    this.setRatioToVars = function (ratio) {\n      var vars = _this.vars,\n          root = _this.root;\n\n      for (var i = 0; i < root.targets.length; i++) {\n        if (!root.targets[i]) {\n          continue;\n        } // root.targets.forEach((_, i) => {\n\n\n        for (var key in vars) {\n          // Object.keys(vars).forEach((key: string) => {\n          var _item = vars[key];\n\n          if (_item.plugins) {\n            if (key === 'PathMotion') {\n              // pathMotion 的属性与 style 通用。不需新增；\n              root.vars[i].style = _item.plugins[i].render(ratio);\n            } else {\n              root.vars[i][key] = _item.plugins[i].render(ratio);\n            }\n\n            continue;\n          }\n\n          var endVars = _item.vars,\n              count = _item.count,\n              unit = _item.unit;\n          var startVars = _this.start[i][key];\n          root.vars[i][key] = getValue(startVars, endVars, ratio, count, unit); //});\n        } //});\n\n      }\n    };\n\n    this.onRegisterAnimate = function () {\n      _this.register = true;\n      var root = _this.root,\n          parent = _this.parent,\n          startAt = _this.startAt;\n      var start = [];\n\n      for (var i = 0; i < root.targets.length; i++) {\n        var target = root.targets[i];\n        var s = {};\n\n        for (var key in _this.vars) {\n          var cItem = _this.vars[key];\n\n          if (cItem.plugins) {\n            var plugin = new Plugins[cItem.array ? 'ArrayPlugin' : key](cItem.value, key);\n            plugin.target = target;\n            plugin.root = root;\n            plugin.parent = parent;\n            plugin.targetIndex = i;\n            plugin.tweenVars = root.vars[i];\n            plugin.index = _this.index;\n            plugin.startAt = _this.startAt;\n            s[key] = plugin.getAnimStart();\n            cItem.plugins.push(plugin);\n          } else {\n            var _ref, _startAt$key;\n\n            var startData = (_ref = (_startAt$key = startAt[key]) !== null && _startAt$key !== void 0 ? _startAt$key : // root.vars[i][key] ??\n            root.attr ? target.getAttribute(key) : target[key]) !== null && _ref !== void 0 ? _ref : getDefaultStart(key);\n            var unit = \"\".concat(startData).replace(/[^a-z|%]/g, '');\n            var varsUnit = cItem.unit;\n\n            if (unit && unit !== varsUnit) {\n              console.warn(\"Different units, start unit \".concat(unit, \", to value unit \").concat(varsUnit, \", remove start unit.\"));\n            }\n\n            s[key] = parseFloat(startData);\n          }\n        }\n\n        start.push(s);\n      }\n\n      _this.start = start;\n    };\n\n    this.overflowRatio = function (ratio) {\n      var r = ratio < 0 ? 0 : ratio;\n      var duration = _this.props.duration;\n      r = r > duration ? duration : r;\n      return r;\n    };\n\n    this.render = function (_ref2) {\n      var moment = _ref2.moment,\n          _ref2$fps = _ref2.fps,\n          fps = _ref2$fps === void 0 ? 0 : _ref2$fps,\n          silence = _ref2.silence,\n          render = _ref2.render;\n      var parent = _this.parent,\n          root = _this.root,\n          props = _this.props;\n      var targets = flatArray(root.targets);\n      var onChange = parent.onChange;\n      var _props$repeat = props.repeat,\n          repeat = _props$repeat === void 0 ? 0 : _props$repeat;\n      var _props$type = props.type,\n          type = _props$type === void 0 ? 'to' : _props$type,\n          _props$duration = props.duration,\n          duration = _props$duration === void 0 ? 450 : _props$duration,\n          _props$delay = props.delay,\n          delay = _props$delay === void 0 ? 0 : _props$delay,\n          _props$repeatDelay = props.repeatDelay,\n          repeatDelay = _props$repeatDelay === void 0 ? 0 : _props$repeatDelay,\n          yoyo = props.yoyo;\n      repeat = repeat === -1 ? Number.MAX_VALUE : repeat;\n      var ratio = moment - delay; // const totalTime = duration + delay;\n\n      var repeatNum = Math.floor(ratio / (duration + repeatDelay)) || 0;\n      repeatNum = repeatNum > repeat ? repeat : repeatNum;\n      repeatNum = repeatNum < 0 ? 0 : repeatNum;\n      ratio = ratio - (duration + repeatDelay) * repeatNum;\n      /**\n       * 反向播放 isFrom 与 yoyoReverse 的区别\n       * 反向播放: isFrom\n       * [---delay---][---isFrom duration---]\n       * yoyo\n       * [---duration---][---delay---]\n       * backwards\n       * 两个都为 true 时为 false;\n       */\n\n      var yoyoReverse = !!(yoyo && repeatNum % 2);\n      var isFrom = type === 'from';\n      var backwards = yoyoReverse && isFrom ? false : yoyoReverse || isFrom;\n      ratio = backwards ? duration - ratio : ratio;\n      var fromDelay = isFrom ? 0 : delay;\n      var r = backwards ? 1 : 0; // 0 进入时的注册\n\n      if (!_this.register && moment >= fromDelay) {\n        _this.onRegisterAnimate(); // 时间超出当前动画时间的处理\n\n\n        if (backwards && ratio <= 0 || !backwards && ratio >= duration && duration) {\n          // this.mode = 'onComplete';\n          _this.prevMoment = moment;\n          r = backwards ? 0 : 1;\n        }\n\n        _this.setRatioToVars(r); // 初始注册，改变外部 vars;\n\n\n        onChange({\n          index: _this.index,\n          vars: root.vars\n        });\n      }\n\n      if (_this.register && moment > delay - fps && moment < _this.totalTime + fps) {\n        ratio = _this.overflowRatio(ratio);\n        r = backwards ? 1 : 0;\n\n        if (moment >= _this.totalTime && _this.mode !== 'onComplete' && _this.prevMoment !== undefined || _this.prevMoment === undefined && moment >= _this.totalTime && duration) {\n          r = backwards ? 0 : 1;\n          _this.mode = 'onComplete';\n\n          if (_this.props.onComplete) {\n            _this.props.onComplete({\n              mode: _this.mode,\n              index: _this.index,\n              moment: ratio,\n              ratio: r,\n              targets: targets,\n              vars: flatArray(root.vars)\n            });\n          }\n        } else if (_this.prevMoment === undefined || moment <= 0 && moment > -fps && _this.mode !== 'onStart' && _this.prevMoment > moment) {\n          _this.mode = 'onStart';\n\n          if (_this.props.onStart) {\n            _this.props.onStart({\n              mode: _this.mode,\n              index: _this.index,\n              moment: ratio,\n              ratio: r,\n              targets: targets,\n              vars: flatArray(root.vars)\n            });\n          }\n        } else {\n          r = ratio / duration;\n          _this.mode = 'onUpdate';\n\n          if (_this.props.onUpdate) {\n            _this.props.onUpdate({\n              mode: _this.mode,\n              index: _this.index,\n              moment: ratio,\n              ratio: r,\n              targets: targets,\n              vars: flatArray(root.vars)\n            });\n          }\n        }\n\n        if (repeat && repeatNum !== _this.repeatNum && moment && _this.mode === 'onUpdate') {\n          _this.mode = 'onRepeat';\n\n          if (_this.props.onRepeat) {\n            _this.props.onRepeat({\n              mode: _this.mode,\n              index: _this.index,\n              moment: ratio,\n              ratio: r,\n              targets: targets,\n              vars: flatArray(_this.root.vars)\n            });\n          }\n        }\n\n        _this.setRatioToVars(_this.getEaseToRatio(r, isFrom));\n\n        if (repeat) {\n          _this.repeatNum = repeatNum;\n        }\n\n        var cb = {\n          mode: _this.mode,\n          moment: ratio,\n          repeat: repeatNum,\n          ratio: r,\n          targets: root.targets,\n          vars: root.vars,\n          index: _this.index\n        };\n\n        if (silence) {\n          cb.silence = silence;\n        }\n\n        if (render) {\n          cb.render = render;\n        }\n\n        onChange(cb);\n        _this.prevMoment = moment;\n      }\n    }; // delete item.appearTo;\n\n\n    this.startAt = item.startAt || {}; // delete item.startAt;\n\n    var props = {};\n\n    for (var k in item) {\n      var value = item[k];\n\n      if (!(k in initAnimProps)) {\n        var isArray = (Array.isArray(value) || k.match(/color|fill|stroke/i) || k.match(/shadow/i) || typeof value === 'string' && value.split(/[\\s|,]/).length > 1) && !(k in Plugins);\n\n        if (k in Plugins || isArray) {\n          this.vars[k] = {\n            value: value,\n            plugins: [],\n            array: isArray\n          };\n        } else {\n          var vars = parseFloat(value.toString().replace(/=/g, ''));\n          var unit = value.toString().replace(/[^a-z|%]/g, ''); // +=, -= 匹配\n\n          var count = value.toString().charAt(1) === '=' ? value.toString().replace(/[^\\+\\=|\\-\\=]/gi, '') : '';\n          var startUnit = (this.startAt[k] || 0).toString().replace(/[^a-z|%]/g, '');\n\n          if (unit !== startUnit && this.startAt[k] && this.startAt[k] !== getDefaultStart(k)) {\n            console.warn(\"Warning: animation vars(\".concat(value, \") units(\").concat(unit || 'px', \") are not equal to startAt(\").concat(startUnit || 'px', \").\"));\n          }\n\n          this.vars[k] = {\n            vars: vars,\n            unit: unit,\n            count: count\n          };\n        }\n      } else {\n        props[k] = value;\n      }\n    }\n\n    this.props = _objectSpread(_objectSpread({}, initAnimProps), props);\n    this.setEase(this.props.ease);\n  }\n\n  _createClass(Element, [{\n    key: \"totalTime\",\n    get: function get() {\n      return this.getTotalTime();\n    }\n  }]);\n\n  return Element;\n}();\n\nexport { Element as default };"]},"metadata":{},"sourceType":"module"}